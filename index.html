<!DOCTYPE html>
<html lang="ta">
<head>
  <meta charset="UTF-8" />
  <title>Meenakshi Finance - வட்டி கணக்கிடும் பயன்பாடு</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { margin:0; font-family:Arial, sans-serif; background:#f2f2f2; color:#222; display:flex; justify-content:center; padding:20px; }
    .container { width:100%; max-width:640px; background:#fff; padding:20px; border-radius:12px; box-shadow:0 5px 15px rgba(0,0,0,0.08); }
    h1 { text-align:center; margin:0 0 8px; font-size:28px; color:#2c3e50; }
    h2 { text-align:center; margin:0 0 16px; font-size:20px; color:#333; }
    label { font-weight:700; font-size:18px; display:block; margin-top:14px; }
    input, button { width:100%; padding:12px; font-size:16px; border:1px solid #ccc; border-radius:8px; margin-top:6px; }
    input[readonly] { background:#f7f7f7; }
    .hint { font-size:14px; color:#555; margin-top:4px; }
    .error { color:#b91c1c; font-size:14px; margin-top:4px; }
    .results { margin-top:20px; border:1px solid #e5e7eb; border-radius:12px; padding:14px; background:#fafafa; }
    .kv { display:flex; justify-content:space-between; padding:6px 0; border-bottom:1px dashed #eaeaea; font-size:17px; }
    .kv:last-child { border-bottom:0; }
    .section { background:#fff; border:1px solid #eaeaea; border-radius:10px; padding:12px; margin-top:12px; }
    .sec-title { font-weight:700; font-size:16px; margin-bottom:8px; }
    .highlight { font-size:22px; font-weight:800; color:#000; }
    .subtle { font-size:15px; color:#444; }
    .breakdown { font-size:14px; color:#555; margin-top:6px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Meenakshi Finance</h1>
    <h2>வட்டி கணக்கிடும் பயன்பாடு</h2>

    <!-- Amount -->
    <label for="amount">தொகை</label>
    <input id="amount" type="number" placeholder="உதா: 43000" />
    <div id="errAmount" class="error"></div>

    <!-- Interest (fixed) -->
    <label for="rate">வட்டி விகிதம் (%)</label>
    <input id="rate" type="number" value="1.25" readonly />
    <div class="hint">விகிதம் எப்போதும் 1.25% (மாதாந்திர அடிப்படை)</div>

    <!-- Dates -->
    <label for="startDate">அடகு பிடிப்பு தேதி</label>
    <input id="startDate" type="date" />
    <div id="errStart" class="error"></div>

    <label for="today">இன்று</label>
    <input id="today" type="date" readonly />
    <div class="hint">இன்று தானாக நிரப்பப்படும் (மாற்ற முடியாது).</div>

    <!-- Auto days + duration -->
    <label>நாட்கள் (தானாக கணக்கிடப்பட்டது)</label>
    <input id="autoDays" type="number" readonly />
    <div id="durationLine" class="hint"></div>

    <!-- Results -->
    <div class="results" id="results" style="display:none;">
      <div class="kv"><div>முதல்தொகை</div><div id="outPrincipal">—</div></div>
      <div class="kv"><div>வட்டி விகிதம்</div><div id="outRate">—</div></div>
      <div class="kv"><div>மொத்த நாட்கள்</div><div id="outDays">—</div></div>

      <div class="section">
        <div class="sec-title">தினசரி (Daily)</div>
        <div class="breakdown" id="dyBreakdown">—</div>
        <div class="kv"><div>மொத்த வட்டி</div><div id="dyInterest" class="highlight">—</div></div>
        <div class="kv"><div class="subtle">மொத்தம் (முதல்தொகை + வட்டி)</div><div id="dyTotal" class="subtle">—</div></div>
      </div>

      <div class="section">
        <div class="sec-title">மாதாந்திர (30 நாட்கள்/மாதம்)</div>
        <div class="breakdown" id="moBreakdown">—</div>
        <div class="kv"><div>மொத்த வட்டி</div><div id="moInterest" class="highlight">—</div></div>
        <div class="kv"><div class="subtle">மொத்தம் (முதல்தொகை + வட்டி)</div><div id="moTotal" class="subtle">—</div></div>
      </div>

      <div class="section">
        <div class="sec-title">வருடாந்திர (365 நாட்கள்/வருடம்)</div>
        <div class="breakdown" id="yrBreakdown">—</div>
        <div class="kv"><div>மொத்த வட்டி</div><div id="yrInterest" class="highlight">—</div></div>
        <div class="kv"><div class="subtle">மொத்தம் (முதல்தொகை + வட்டி)</div><div id="yrTotal" class="subtle">—</div></div>
      </div>
    </div>
  </div>

<script>
  // --- Helpers ---
  function formatINR(v){ return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(v); }
  function r2(x){ return Math.round((x + Number.EPSILON) * 100) / 100; }
  function toDateInputValue(d){ const pad=n=>String(n).padStart(2,'0'); return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`; }
  function diffDays(start, end){
    const ms=24*60*60*1000;
    const s=Date.UTC(start.getFullYear(),start.getMonth(),start.getDate());
    const e=Date.UTC(end.getFullYear(),end.getMonth(),end.getDate());
    return Math.floor((e - s)/ms);
  }
  function breakdownMonths(days){
    const m = Math.floor(days/30);
    const d = days % 30;
    return {m, d};
  }
  function breakdownYears(days){
    const y = Math.floor(days/365);
    const rem = days % 365;
    const m = Math.floor(rem/30);
    const d = rem % 30;
    return {y, m, d};
  }
  function humanMD(days){
    const {m,d} = breakdownMonths(days);
    if (m>0 && d>0) return `${m} மாதம் ${d} நாள்`;
    if (m>0) return `${m} மாதம்`;
    return `${d} நாள்`;
  }
  function humanYMD(days){
    const {y,m,d} = breakdownYears(days);
    let bits = [];
    bits.push(`${y} வருடம்`);
    bits.push(`${m} மாதம்`);
    bits.push(`${d} நாள்`);
    return bits.join(' ');
  }

  // --- State / DOM ---
  const els = {
    amount: document.getElementById('amount'),
    startDate: document.getElementById('startDate'),
    today: document.getElementById('today'),
    autoDays: document.getElementById('autoDays'),
    errAmount: document.getElementById('errAmount'),
    errStart: document.getElementById('errStart'),
    results: document.getElementById('results'),
    outPrincipal: document.getElementById('outPrincipal'),
    outRate: document.getElementById('outRate'),
    outDays: document.getElementById('outDays'),
    dyBreakdown: document.getElementById('dyBreakdown'),
    moBreakdown: document.getElementById('moBreakdown'),
    yrBreakdown: document.getElementById('yrBreakdown'),
    dyInterest: document.getElementById('dyInterest'),
    dyTotal: document.getElementById('dyTotal'),
    moInterest: document.getElementById('moInterest'),
    moTotal: document.getElementById('moTotal'),
    yrInterest: document.getElementById('yrInterest'),
    yrTotal: document.getElementById('yrTotal'),
  };

  // Init today + prevent future start date
  function setTodayAndMax(){
    const now = new Date();
    const todayStr = toDateInputValue(now);
    els.today.value = todayStr;
    els.startDate.setAttribute('max', todayStr);
  }

  function recalcDays(){
    const sVal = els.startDate.value;
    if (!sVal){ els.autoDays.value = ""; return; }
    const s = new Date(sVal);
    const t = new Date(els.today.value);
    let days = diffDays(s,t);
    if (days < 0) days = 0;
    els.autoDays.value = days;
  }

  function validate(){
    let ok = true;
    els.errAmount.textContent = "";
    els.errStart.textContent = "";

    if (!(els.amount.value && Number(els.amount.value) > 0)){
      els.errAmount.textContent = "சரியான தொகையை உள்ளிடவும் (0-ஐ விட அதிகமாக)."; ok = false;
    }
    if (!els.startDate.value){
      els.errStart.textContent = "அடகு பிடிப்பு தேதியைத் தேர்வுசெய்யவும்."; ok = false;
    } else {
      const s = new Date(els.startDate.value), t = new Date(els.today.value);
      if (s > t){ els.errStart.textContent = "அடகு தேதி வருங்காலத்தில் இருக்கக்கூடாது."; ok = false; }
    }
    return ok;
  }

  function calculateAndRender(){
    setTodayAndMax();
    recalcDays();

    if (!validate()){ els.results.style.display = 'none'; return; }

    const P = Number(els.amount.value);
    const ratePct = 1.25;
    const days = Number(els.autoDays.value || 0);

    // Base amounts per your logic
    const monthly = P * (ratePct/100); // 30-day month
    const daily   = monthly / 30;
    const yearly  = daily * 365;

    // Totals for elapsed days
    const intDays = daily   * days;      // exact days
    const intMons = monthly * (days/30); // months-equivalent
    const intYear = yearly  * (days/365);// years-equivalent

    // Header facts
    els.outPrincipal.textContent = formatINR(P);
    els.outRate.textContent = `${ratePct}%`;
    els.outDays.textContent = `${days}`;

    // Breakdowns
    els.dyBreakdown.textContent = `நாட்கள்: ${days} நாள்`;
    els.moBreakdown.textContent = `மாத அளவு: ${humanMD(days)} (30 நாள்/மாதம்)`;
    els.yrBreakdown.textContent = `வருட அளவு: ${humanYMD(days)} (365 நாள்/வருடம், 30 நாள்/மாதம்)`;

    // Numbers
    const r = r2;
    els.dyInterest.textContent = formatINR(r(intDays));
    els.dyTotal.textContent    = formatINR(r(P + intDays));

    els.moInterest.textContent = formatINR(r(intMons));
    els.moTotal.textContent    = formatINR(r(P + intMons));

    els.yrInterest.textContent = formatINR(r(intYear));
    els.yrTotal.textContent    = formatINR(r(P + intYear));

    els.results.style.display = 'block';
  }

  // Live updates
  ['input','change'].forEach(evt=>{
    els.amount.addEventListener(evt, calculateAndRender);
    els.startDate.addEventListener(evt, calculateAndRender);
  });

  // Boot
  window.addEventListener('load', ()=>{ setTodayAndMax(); calculateAndRender(); });
</script>
</body>
</html>
